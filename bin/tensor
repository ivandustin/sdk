#!/usr/bin/env python
from sys import argv, stdin, stdout
from pyarrow import Tensor, output_stream
from pyarrow.ipc import write_tensor
from numpy import array


def main():
    typename = argv[1]
    stream = output_stream(stdout.buffer)
    for line in stdin:
        x = array(line.strip().split(" "), dtype=typename)
        tensor = Tensor.from_numpy(x)
        write_tensor(tensor, stream)


if __name__ == "__main__":
    main()
